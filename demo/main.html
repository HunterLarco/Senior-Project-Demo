<!DOCTYPE html>
<style>

body{
  font-family:arial;
}

canvas{
  position:fixed;
  top:0px;
  left:0px;
  
  width:100%;
  height:100%;
}

</style>
<html>
<head>

<title>Perceptron Demo</title>

<meta charset="utf-8" />

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">

<meta content="minimum-scale=1.0, width=device-width, maximum-scale=1, user-scalable=no" name="viewport"/>

<link rel="stylesheet" href="/resources/css/resets.css"/>

<script src='/resources/scripts/classie.js'></script>
<script src='/resources/scripts/requestAnimFrame.js'></script>
<script src='/resources/scripts/overload.min.js'></script>

</head>
<body>


<canvas></canvas>


<script type='text/javascript'>
(function(){
  
  window.addEventListener('load', Init);
  
  function Init(){
    GenParticles(100);
    var background = LoadCanvas(document.querySelector('canvas'), RenderBackground);
    background.start();
  }
  
  var particles = [];
  
  var GenParticles = Overload.function();
  GenParticles.overload(function(){
    particles.push({
      x: Math.random(),
      y: Math.random(),
      s: Math.random()/2+.5
    });
  });
  GenParticles.overload(function(num){
    for(var i=0; i<num; i++)
      this();
  });
  
  function RenderBackground(canvas, ctx, width, height){
    ctx.clearRect(0, 0, width, height);
    
    for(var i=0,particle; particle=particles[i++];){
      var x = width*particle.x,
          y = height*particle.y;
      
      ctx.fillStyle = 'rgb(200,200,200)';
      
      ctx.beginPath();
      ctx.arc(x, y, 6, 0, Math.PI*2, false);
      ctx.fill();
      
      particle.x -= .0005*particle.s;
      particle.y += .0005*particle.s;
      particle.x = (particle.x+1)%1;
      particle.y = (particle.y+1)%1;
    }
  }
  
  function LoadCanvas(canvas, Renderer){
    var ctx, width, height;
    var stopRender = false, isRunning = false;
    
    (function Load(){
      ctx = canvas.getContext('2d');
      
      ResizeCanvas();
      window.addEventListener('resize', ResizeCanvas);
    })();
    
    function ResizeCanvas(){
      width = canvas.width = canvas.offsetWidth;
      height = canvas.height = canvas.offsetHeight;
    }
    
    function Render(){
      Renderer(canvas, ctx, width, height);
    }
    function Stop(){
      stopRender = true;
    }
    function Start(){
      if(isRunning) return;
      stopRender = false;
      
      (function Run(){
        if(stopRender) return;
        
        requestAnimationFrame(Run);
        Renderer(canvas, ctx, width, height);
      })();
    }
    
    return {
      'stop': Stop,
      'start': Start,
      'render': Render
    };
  }
  
})();
</script>
</body>
</html>
